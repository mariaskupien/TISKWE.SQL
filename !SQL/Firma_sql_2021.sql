create database firma
go--ci¹g poleceñ bezpoœrednio kierowany do serwera powinien koñczyæ siê s³owem kluczowym GO.

use firma
go

set dateformat ymd;
go

--ALTER TABLE PRZYDZIALY DROP CONSTRAINT FK_PRZYDZIALY_PRACOWNICY;
--ALTER TABLE PRZCOWNICY DROP CONSTRAINT FK_ETAT
--ALTER TABLE PRACOWNICY DROP CONSTRAINT FK_ID_ZAKL
--DROP TABLE PRZYDZIALY;
--DROP TABLE PROJEKTY;
--DROP TABLE WYPLATY;
--DROP TABLE PRACOWNICY;
--DROP TABLE ZAKLADY;
--DROP TABLE ETATY;

 
CREATE TABLE ZAKLADY
	(ZAKL_ID INT IDENTITY(10,10) CONSTRAINT PK_ZAKLADY PRIMARY KEY,
	ZAKL_NAZWA VARCHAR(25),
	ZAKL_MIASTO VARCHAR(20),
	ZAKL_ULICA VARCHAR(30) );

CREATE TABLE ETATY
      ( ETAT_NAZWA VARCHAR(15) CONSTRAINT PK_ETAT PRIMARY KEY,
	ETAT_PLACA_MIN NUMERIC(8,2),
	ETAT_PLACA_MAX NUMERIC(8,2));

CREATE TABLE PRACOWNICY
       (PRAC_ID NUMERIC(4) CONSTRAINT PK_PRAC PRIMARY KEY,
	PRAC_IMIE VARCHAR(15),
	PRAC_NAZWISKO VARCHAR(15),
	PRAC_ETAT_NAZWA VARCHAR(15) CONSTRAINT FK_ETAT REFERENCES ETATY(ETAT_NAZWA),
	PRAC_ID_SZEFA NUMERIC(4) CONSTRAINT FK_ID_SZEFA REFERENCES PRACOWNICY(PRAC_ID), 
	PRAC_DATA_ZATRUD DATETIME,
	PRAC_PLACA_POD NUMERIC(8,2) CONSTRAINT MIN_PLACA_POD CHECK(PRAC_PLACA_POD>500),
	PRAC_PLACA_DOD NUMERIC(6,2),
	PRAC_ZAKL_ID INT CONSTRAINT FK_ID_ZAKL REFERENCES ZAKLADY(ZAKL_ID));
  
CREATE TABLE PROJEKTY (
	PROJ_ID int IDENTITY (1, 1) CONSTRAINT PK_PROJEKTY PRIMARY KEY,
	PROJ_OPIS varchar(50) NULL ,
	PROJ_DATA_ROZP datetime NOT NULL ,
	PROJ_DATA_ZAKON datetime NULL ,
	PROJ_FUNDUSZ money CONSTRAINT DF_PROJ_FUNDUSZ DEFAULT 0 NULL
)
ALTER TABLE PROJEKTY WITH NOCHECK ADD 
CONSTRAINT CK_PROJEKTY_DATA CHECK (PROJ_DATA_ROZP < PROJ_DATA_ZAKON);

CREATE TABLE PRZYDZIALY (
	PRZYDZ_ID int IDENTITY (1, 1) CONSTRAINT PK_PRZYDZIALY PRIMARY KEY,
	PRZYDZ_PRAC_ID NUMERIC(4) CONSTRAINT FK_PRZYDZIALY_PRACOWNICY REFERENCES PRACOWNICY(PRAC_ID),
	PRZYDZ_PROJ_ID INT CONSTRAINT FK_PRZYDZIALY_PROJEKTY REFERENCES PROJEKTY(PROJ_ID),
	PRZYDZ_DATA_OD DATETIME,
	PRZYDZ_DATA_DO DATETIME,
	PRZYDZ_STAWKA MONEY,
	PRZYDZ_ROLA VARCHAR(20)
)
ALTER TABLE PRZYDZIALY WITH NOCHECK ADD 
	CONSTRAINT CK_PRZYDZIALY_ROLA CHECK(PRZYDZ_ROLA IN ('WYKONAWCA','ASYSTENT','KIEROWNIK')),
	CONSTRAINT CK_PRZYDZIALY_DATA CHECK (PRZYDZ_DATA_OD < PRZYDZ_DATA_DO);

CREATE TABLE WYPLATY (
	WYPL_ID int IDENTITY(1, 1) CONSTRAINT PK_WYPLATY PRIMARY KEY,
	WYPL_DATA DATETIME,
	WYPL_KWOTA MONEY,
	WYPL_TYP CHAR(10) CONSTRAINT CK_WYPLATY_TYP_WYPLATY CHECK(WYPL_TYP IN ('PODSTAWOWA','DODATKOWA')) DEFAULT 'PODSTAWOWA',
	WYPL_PRAC_ID NUMERIC(4) CONSTRAINT FK_WYPLATY_PRACOWNICY REFERENCES PRACOWNICY(PRAC_ID)
)

 
INSERT INTO ZAKLADY VALUES ('Zak³ad Opraw','Gniezno','Królów 52');
INSERT INTO ZAKLADY VALUES ('Zak³ad Zasilaczy','Poznañ','Hetmañska 135');
INSERT INTO ZAKLADY VALUES ('Administracja', 'Poznañ','Œw. Marcin 13');
INSERT INTO ZAKLADY VALUES ('Zak³ad ¯arówek','Pi³a','Bohaterów 32');
INSERT INTO ZAKLADY VALUES ('Zak³ad Lamp','Pi³a','Niez³omnych 7');
INSERT INTO ZAKLADY VALUES ('Zak³ad Kloszy','Gniezno','Królów 52');

INSERT INTO ETATY VALUES ('Dyrektor',5000.00,15000.00);
INSERT INTO ETATY VALUES ('Kierownik',2000.00, 4500.00);
INSERT INTO ETATY VALUES ('Mistrz',1500.00,4500.00);
INSERT INTO ETATY VALUES ('Sekretarka',1000.00, 2500.00);
INSERT INTO ETATY VALUES ('Ksiêgowy',3000.00, 6000.00);
INSERT INTO ETATY VALUES ('Czeladnik',800.00,3000.00);

INSERT INTO PRACOWNICY VALUES (100,'Bogdan','Nowak','Dyrektor',NULL,'1992-08-14',6500.00,NULL,30);
INSERT INTO PRACOWNICY VALUES (110,'Artur','Piotrowski','Kierownik',100,'1992-04-23',3200.00,NULL,10);
INSERT INTO PRACOWNICY VALUES (120,'Daniel','Mickiewicz','Mistrz',110,'2000-03-01',3120.00,100.00,10);
INSERT INTO PRACOWNICY VALUES (130,'Micha³','¯ebrowski','Kierownik',100,'1999-08-01',2900.00,NULL,20);
INSERT INTO PRACOWNICY VALUES (140,'Marcin','Wolski','Mistrz',130,'1993-10-17',2900.00,NULL,20);
INSERT INTO PRACOWNICY VALUES (150,'Krzysztof','Kot','Czeladnik',150,'1993-10-17',1600.00,NULL,10);
INSERT INTO PRACOWNICY VALUES (160,'Mateusz','Mocny','Czeladnik',140,'1994-03-05',2000.00,50.00,20);
INSERT INTO PRACOWNICY VALUES (170,'Dawid','Kowalski','Ksiêgowy',100,'1993-05-03',4400.00,800.00,30);
INSERT INTO PRACOWNICY VALUES (180,'Wojciech','Smyczek','Kierownik',100,'1994-01-02',3350.00,NULL,40);
INSERT INTO PRACOWNICY VALUES (190,'Bogus³aw','Linda','Mistrz',180,'1998-01-04',2250.00,NULL,40);
INSERT INTO PRACOWNICY VALUES (200,'Kamil','Szymañski','Czeladnik',190,'1992-05-06',1900.00,NULL,40);
INSERT INTO PRACOWNICY VALUES (210,'Cezary','Pazura','Kierownik',100,'1990-08-29',3000.00,300.00,50);
INSERT INTO PRACOWNICY VALUES (220,'Szymon','Mokry','Mistrz',210,'1992-04-01',2640.00,NULL,50);
INSERT INTO PRACOWNICY VALUES (230,'Andrzej','Grzelak','Czeladnik',220,'1994-11-15',1900.00,NULL,50);
INSERT INTO PRACOWNICY VALUES (240,'Jacek','Malczewski','Czeladnik',150,'1997-12-07',1500.00,300,10);
INSERT INTO PRACOWNICY VALUES (250,'Adam','Mickiewicz','Czeladnik',140,'1999-07-25',1950.00,50.00,20);
INSERT INTO PRACOWNICY VALUES (260,'Jolanta','Skrztulska','Sekretarka',100,'2001-01-03',1400.00,300.00,30);
INSERT INTO PRACOWNICY VALUES (270,'Edward','Raczyñski','Czeladnik',190,'1996-02-16',1900.00,180,40);
INSERT INTO PRACOWNICY VALUES (280,'Kamil','Baczyñski','Czeladnik',220,'2000-10-01',2050.00,NULL,50);

INSERT INTO PROJEKTY VALUES ('Projekt oprawy rtêciowej','2004-10-01',NULL,10000);
INSERT INTO PROJEKTY VALUES ('Projekt oprawy sodowej','2004-09-01',NULL,97000);
INSERT INTO PROJEKTY VALUES ('Projekt zap³onnika do jarzeniówki','2003-05-01','2004-02-01',38000);
INSERT INTO PROJEKTY VALUES ('Projekt oprawy do oœwietlenia autostrady','2004-03-01',NULL,230000);
INSERT INTO PROJEKTY VALUES ('Projekt opakowania do ¿arówki','2003-09-15','2004-05-19',16000);

INSERT INTO PRZYDZIALY VALUES (120,1,'2003-05-03','2004-02-10',15000,'Kierownik');
INSERT INTO PRZYDZIALY VALUES (180,2,'2003-05-06','2003-11-10',800,'Wykonawca');
INSERT INTO PRZYDZIALY VALUES (140,3,'2004-07-13','2004-12-10',1100,'Asystent');
INSERT INTO PRZYDZIALY VALUES (230,4,'2004-08-20','2004-11-10',800,'Wykonawca');
INSERT INTO PRZYDZIALY VALUES (210,5,'2004-09-30','2004-11-10',750,'Wykonawca');
INSERT INTO PRZYDZIALY VALUES (110,2,'2003-05-06','2003-11-10',15000,'Kierownik');
INSERT INTO PRZYDZIALY VALUES (110,4,'2004-08-20','2004-11-10',15000,'Kierownik');
INSERT INTO PRZYDZIALY VALUES (130,5,'2003-09-20','2004-05-19',14000,'Kierownik');
INSERT INTO PRZYDZIALY VALUES (200,5,'2003-09-21','2004-05-10',1100,'Asystent');


INSERT INTO WYPLATY VALUES ('2005-01-10',1520,DEFAULT,150);
INSERT INTO WYPLATY VALUES ('2005-02-10',1530,DEFAULT,150);
INSERT INTO WYPLATY VALUES ('2005-03-10',1540,DEFAULT,150);
INSERT INTO WYPLATY VALUES ('2005-10-10',1550,DEFAULT,150);
INSERT INTO WYPLATY VALUES ('2005-10-12',500,'DODATKOWA',150);
INSERT INTO WYPLATY VALUES ('2005-11-10',1600,'PODSTAWOWA',150);
INSERT INTO WYPLATY VALUES ('2005-10-11',620,'DODATKOWA',150);
INSERT INTO WYPLATY VALUES ('2006-01-01',3500,DEFAULT,100);
INSERT INTO WYPLATY VALUES ('2006-02-01',3500,DEFAULT,100);
INSERT INTO WYPLATY VALUES ('2006-03-01',3500,DEFAULT,100);
INSERT INTO WYPLATY VALUES ('2006-04-01',3600,DEFAULT,100);
INSERT INTO WYPLATY VALUES ('2006-05-01',3600,DEFAULT,100);
INSERT INTO WYPLATY VALUES ('2006-06-01',3700,DEFAULT,100);
INSERT INTO WYPLATY VALUES ('2006-07-01',4500,DEFAULT,100);
INSERT INTO WYPLATY VALUES ('2006-01-01',3500,'DODATKOWA',100);
INSERT INTO WYPLATY VALUES ('2006-03-01',1500,'DODATKOWA',100);
INSERT INTO WYPLATY VALUES ('2006-05-01',2000,'DODATKOWA',100);
INSERT INTO WYPLATY VALUES ('2006-01-01',3000,'DODATKOWA',100);
INSERT INTO WYPLATY VALUES ('2006-07-01',12000,'DODATKOWA',100);